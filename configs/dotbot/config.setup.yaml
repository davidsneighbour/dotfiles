---
################################################################################
# Setup configuration for Dotbot
#
# @see https://github.com/anishathalye/dotbot for more info
################################################################################

- defaults:
    shell:
      quiet: true
      description: <<<<<<<<####### DESCRIPTION MISSING

- shell:
    -
      description: Setup directories
      command: mkdir -p ~/github.com/davidsneighbour ~/gitlab.com/davidsneighbour ~/.config
    -
      description: Add individual PPAs
      command: |
        sudo add-apt-repository ppa:flatpak/stable --yes
        sudo add-apt-repository ppa:libreoffice/ppa --yes
        sudo add-apt-repository ppa:papirus/papirus --yes
    -
      description: Install essentials and requirements
      command: |
        sudo apt autoremove -y
        sudo apt-get install \
          build-essential procps curl file \
          meson libgirepository1.0-dev libgtk-3-dev python3 python3-gi \
          gir1.2-rsvg-2.0 librsvg2-bin gir1.2-gtk-3.0 \
          xclip dnsmasq-base gzip git \
          ca-certificates rofi \
          vlc shutter zoxide \
          papirus-icon-theme filezilla-theme-papirus papirus-folders \
          dconf-editor inxi \
          -y
    -
      description: Install Homebrew
      command: |
        NONINTERACTIVE=1 \
        /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)" --quiet
    -
      description: Install Homebrew packages
      command: brew install git-delta zoxide typos-cli gum yamllint vale lychee python jrnl fastfetch
    -
      description: Install and setup Node and NPM
      command: |
        curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash
        export NVM_DIR="$HOME/.nvm"
        [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
        [ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"
        nvm install v20
        nvm install v22
        nvm install v24
        nvm use v24
    -
      description: Install Flatpak programs
      command: |
        flatpak install flathub be.alexandervanhee.gradia
    -
      description: Install Starship (CLI prompt modification)
      command: |
        wget https://starship.rs/install.sh -O install.sh
        sh install.sh --verbose --yes
        rm install.sh
    -
      description: Install Deno
      command: curl -fsSL https://deno.land/install.sh | sh
    -
      description: Install Ollama (only on UNKLE)
      command: |
        if [[ "$(hostname)" == "unkle" ]]; then
            curl -fsSL https://ollama.com/install.sh | sh
            ollama pull llama3.2
            ollama pull gemma3
        fi
    -
      description: Install AnyDesk
      command: |
        if [[ "$(hostname)" == "unkle" ]]; then
          wget -qO - https://keys.anydesk.com/repos/DEB-GPG-KEY | sudo gpg --dearmor -o /usr/share/keyrings/anydesk.gpg
          echo "deb [signed-by=/usr/share/keyrings/anydesk.gpg] http://deb.anydesk.com/ubuntu focal main" | sudo tee /etc/apt/sources.list.d/anydesk.list
          sudo apt update && sudo apt install anydesk
          sudo systemctl disable --now anydesk.service 2>/dev/null || true
        fi

    -
      description: Remove unused packages
      command: |
        sudo apt purge --yes \
          *-cursor-theme yaru-*
    -
      description: Update system
      command: |
        sudo apt update
        sudo apt upgrade --yes
        sudo apt dist-upgrade --yes
        sudo apt autoremove --yes
        sudo apt clean --yes
    -
      description: System settings
      command: |
        gsettings set org.nemo.desktop show-desktop-icons false
